import tkinter as tk
from tkinter import ttk

def analyze_url():
    url = url_entry.get()
    # Simulated results from different sources
    results = [
        ("Google Safe Browsing", "Safe"),
        ("VirusTotal", "Flagged by 3 engines"),
        ("IOC Search", "PhishTank reports as Malicious"),
        ("Domain Age", "120 days"),
        ("Domain IP", "192.168.1.1")
    ]
    
    # Clear existing table data
    for row in result_table.get_children():
        result_table.delete(row)
    
    # Insert new results
    for source, verdict in results:
        tag = "safe" if "Safe" in verdict else "malicious" if "Malicious" in verdict else "suspicious"
        result_table.insert("", "end", values=(source, verdict), tags=(tag,))

def setup_ui():
    global url_entry, result_table
    
    root = tk.Tk()
    root.title("Malicious URL Analyzer")
    root.geometry("700x400")
    
    tk.Label(root, text="Enter URL:", font=("Helvetica", 12)).pack(pady=5)
    url_entry = tk.Entry(root, width=50, font=("Helvetica", 12))
    url_entry.pack(pady=5)
    tk.Button(root, text="Analyze", command=analyze_url).pack(pady=5)
    
    columns = ("Source", "Verdict")
    result_table = ttk.Treeview(root, columns=columns, show="headings")
    result_table.heading("Source", text="Source")
    result_table.heading("Verdict", text="Verdict")
    result_table.pack(pady=10, fill="both", expand=True)
    
    result_table.tag_configure("safe", background="lightgreen")
    result_table.tag_configure("suspicious", background="yellow")
    result_table.tag_configure("malicious", background="lightcoral")
    
    root.mainloop()

setup_ui()
